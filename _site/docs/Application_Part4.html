<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Spatial Analysis | Module 4</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Spatial Analysis" /> <meta property="og:locale" content="en_US" /> <meta property="og:site_name" content="Module 4" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Spatial Analysis" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/docs/Application_Part4.html","headline":"Spatial Analysis","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> Module 4 </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Spatial Data Models category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/" class="nav-list-link">Spatial Data Models</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Spatial is Special category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/Content_Part2_0.html" class="nav-list-link">Spatial is Special</a><ul class="nav-list"></ul></li><li class="nav-list-item "><a href="/docs/Content_Part2_1.html" class="nav-list-link">Raster Data</a></li><li class="nav-list-item "><a href="/docs/Content_Part2_2.html" class="nav-list-link">Vector Data</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Choice of Data Model category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/Content_Part2_3.html" class="nav-list-link">Choice of Data Model</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Lab Application category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/docs/Application.html" class="nav-list-link">Lab Application</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/Application_Part1.html" class="nav-list-link">Set Up</a></li><li class="nav-list-item "><a href="/docs/Application_Part2.html" class="nav-list-link">Satellite Data</a></li><li class="nav-list-item "><a href="/docs/Application_Part3.html" class="nav-list-link">Data Exploration</a></li><li class="nav-list-item active"><a href="/docs/Application_Part4.html" class="nav-list-link active">Spatial Analysis</a></li><li class="nav-list-item "><a href="/docs/Application_Part5.html" class="nav-list-link">Data Visualization</a></li></ul></li><li class="nav-list-item"><a href="/docs/Assessment.html" class="nav-list-link">Assessment</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Module 4" aria-label="Search Module 4" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://geos270.github.io/Syllabus/docs/Overview.html#course-schedule" class="site-button" > Course Schedule </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/GEOS270/Module4" class="site-button" > View on github </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/Application.html">Lab Application</a></li> <li class="breadcrumb-nav-list-item"><span>Spatial Analysis</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#clear-your-selection" id="markdown-toc-clear-your-selection">Clear Your Selection</a></li> <li><a href="#zonal-statistics" id="markdown-toc-zonal-statistics">Zonal Statistics</a></li> <li><a href="#raster-to-polygon-conversion" id="markdown-toc-raster-to-polygon-conversion">Raster to Polygon Conversion</a> <ol> <li><a href="#intersect" id="markdown-toc-intersect">Intersect</a></li> <li><a href="#add--calculate-field" id="markdown-toc-add--calculate-field">Add &amp; Calculate Field</a></li> <li><a href="#summary-table" id="markdown-toc-summary-table">Summary Table</a></li> <li><a href="#join-the-summary-table" id="markdown-toc-join-the-summary-table">Join the Summary Table</a></li> <li><a href="#data-normalization" id="markdown-toc-data-normalization">Data Normalization</a></li> </ol> </li> <li><a href="#inspect-and-compare-the-outputs" id="markdown-toc-inspect-and-compare-the-outputs">Inspect and Compare the Outputs</a></li> </ol> </details><hr /> <h1 class="no_toc" id="spatial-analysis"> <a href="#spatial-analysis" class="anchor-heading" aria-labelledby="spatial-analysis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Spatial Analysis </h1> <p>A key aspect of GIS is overlaying multiple data layers to generate new information. There are typically multiple solutions to a given problem in GIS. Here, we are going to look at two methods for combining a raster image and a vector layer:</p> <p>1) <strong>Zonal Statistics</strong>: This method is slightly faster, but can be applied in a more limited number of circumstances.</p> <p>2) <strong>Raster to Polygon Conversion</strong>: This method involves converting between data types and requires more a few steps, but it is more flexible.</p> <h1 id="clear-your-selection"> <a href="#clear-your-selection" class="anchor-heading" aria-labelledby="clear-your-selection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Clear Your Selection </h1> <p>Before proceeding with these step <strong>Clear your Selection</strong> in Van_DA_2016. This is an important pitfall that commonly trips people up. <strong>Always</strong> check if you have an active selection. If things don’t work how you expect them too!</p> <ul> <li>If you still have rows selected, they will appear in cyan in the when the layer is turned on. When you have a selection, and try to run a process, ArcPro will only run the process on the selected records. We want to run it on all records, so we must hit clear selection first!</li> <li>You can clear the selection by clicking the “Clear” button found on the Map ribbon at the top.</li> </ul> <p><img src="content/images/clear_selection.png" alt="hi" class="inline" /></p> <h1 id="zonal-statistics"> <a href="#zonal-statistics" class="anchor-heading" aria-labelledby="zonal-statistics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Zonal Statistics </h1> <p>We are going to overlay the vector data on the raster data to measure the mean NDVI value for each DA in the city of Vancouver using the <strong>Zonal Statistics as Table</strong> tool. Then we will <strong>Join</strong> the resulting output table to display the mean NDVI values per DA. A join is a way to add tables to a layer based on a specific column.</p> <p><strong class="label label-red">1</strong> Find the Zonal Statistics as Table tool in the Geoprocessing pane, choose <strong>Van_DA_2016</strong> as the feature zone data, and <strong>Van_Greenest_ProjectRaster</strong> as the Input value raster.</p> <ul> <li>Set DAUID as the Zone Field</li> <li>Select All statistics types</li> <li>Run</li> </ul> <p><strong class="label label-red">3</strong> Right click on Van_DA_2016 and choose Joins and Relates &gt; Add Join.</p> <ul> <li>Set DAUID as the Input Join Field</li> <li>Choose the Zonal Statistics table as your input. <em>(the name should look something like ZonalST_Van_DA_1)</em></li> <li>Make sure DAUID is selected as the Join Table Field as well</li> <li>Click OK</li> </ul> <p><strong class="label label-red">3</strong> Inspect the Join</p> <ul> <li>Open the attribute table and note the new columns at the end</li> <li>Change the symbology, and choose Mean as the Field</li> <li>Zoom in, turn Van_DA_2016 layer on/off, compare to the classification, NDVI layer, and base map. Confirm the values make sense given the inputs</li> </ul> <div style="overflow: hidden; padding-top: 56.25%; position: relative"> <iframe src="content/videos/ZonalStats.mp4" title="Processes" scrolling="no" frameborder="0" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"> <p>Your browser does not support iframes.</p> </iframe> </div> <p><a href="content/videos/ZonalStats.mp4" target="_blank">View Image in New Tab</a></p> <!-- ### QA5 What is the DAUID of the DA with the highest Mean NDVI value? *Hint* Double clicking on Green Veg Area in the attribute table allows you to sort in ascending/descending order. --> <h1 id="raster-to-polygon-conversion"> <a href="#raster-to-polygon-conversion" class="anchor-heading" aria-labelledby="raster-to-polygon-conversion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Raster to Polygon Conversion </h1> <p>We are going to convert the Classification raster layer to a vector layer. Then we can overlay the resulting vector layer with the Van_DA_2016 layer using an intersect and identify the total green vegetation area per DA.</p> <p><strong class="label label-blue">1</strong> Find the <strong>Raster to Polygon</strong> tool in the geoprocessing pane.</p> <ul> <li>Set the Classified NDVI image as the Input raster</li> <li>Choose Value as the Field</li> <li>You can just accept the default name, this is only an intermediate step.</li> </ul> <p><strong class="label label-blue">2</strong> Set the Symbology to Unique Values and choose gridcode as the Field</p> <ul> <li>Zoom into somewhere of interest (eg. I chose Trout Lake), toggle the newly created vector layer on and off to see if it makes sense.</li> </ul> <div style="overflow: hidden; padding-top: 56.25%; position: relative"> <iframe src="content/videos/RasterToPoly.mp4" title="Processes" scrolling="no" frameborder="0" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"> <p>Your browser does not support iframes.</p> </iframe> </div> <p><a href="content/videos/RasterToPoly.mp4" target="_blank">View Image in New Tab</a></p> <h2 id="intersect"> <a href="#intersect" class="anchor-heading" aria-labelledby="intersect"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Intersect </h2> <p>The <a href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/analysis/intersect.htm">Intersect tool</a> is one of the most useful vector - vector overlay operations. It will combine the feature classes where they overlap and exclude all other areas. We’ll talk a lot more about this tool and other options down the line in Module 4</p> <p><strong class="label label-blue">3</strong> Find the Intersect tool in the geoprocessing pane. Set Van_DA_2016 and the output from the raster to polygon conversion as the inputs. Then click run.</p> <ul> <li>Change the symbology and open the attribute table to confirm the results look like what we’d expect.</li> </ul> <div style="overflow: hidden; padding-top: 56.25%; position: relative"> <iframe src="content/videos/Intersect.mp4" title="Processes" scrolling="no" frameborder="0" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"> <p>Your browser does not support iframes.</p> </iframe> </div> <p><a href="content/videos/Intersect.mp4" target="_blank">View Image in New Tab</a></p> <h2 id="add--calculate-field"> <a href="#add--calculate-field" class="anchor-heading" aria-labelledby="add--calculate-field"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Add &amp; Calculate Field </h2> <p>Adding new fields to our attribute table allows us to perform calculations or copy a subset of our data to a new column.</p> <p><strong class="label label-blue">4</strong> In the Van_DA_2016_Intersect attribute table, click Field: <strong>Add</strong>.</p> <ul> <li>Name the field Green_Veg_Area and give it an alias without the underscores. <ul> <li>Arc doesn’t allow spaces in column names.</li> </ul> </li> <li>Make sure the data type is <strong>Double</strong>. <ul> <li>Double is a type of data that allows for decimals. The default is “Long”, which is an integer (no decimals) but we want decimals!</li> </ul> </li> <li>Make sure to save the field then close the field window and go back to the attribute table.</li> </ul> <p><strong class="label label-blue">5</strong> Choose Select by Attribute and set your query to: Where gridcode is equal to 3.</p> <ul> <li>Our condition is that gridcode (attribute from the NDVI layer representing vegetation category) is equal to 3 (green vegetation).</li> </ul> <p><strong class="label label-blue">6</strong> Right click on Green Veg Area and choose <strong>Calculate Field</strong>. This allows us to define a function and apply it to the table.</p> <ul> <li>Set the expression to: Green_Veg_Area = Shape_Area <ul> <li><em>Note 1</em> you only need to complete the right side of the equation</li> <li><em>Note 2</em> If you are unable to click the <strong>Calculate Field</strong> button, go to the edit tab and click edit (pencil icon).</li> <li>This will simply copy the shape area for the green vegetation areas, we will work with a more complex expression on the next page.</li> </ul> </li> </ul> <p><strong class="label label-blue">7</strong> We want to assign all other rows a 0. We can quickly invert our selection with the <strong>Switch</strong> button.</p> <ul> <li>Calculate the field again, but with Green_Veg_Area = 0 <ul> <li>We have selected gridcode 1 &amp; 2 (Not vegetation) so they all get zeros.</li> </ul> </li> </ul> <div style="overflow: hidden; padding-top: 56.25%; position: relative"> <iframe src="content/videos/AddField.mp4" title="Processes" scrolling="no" frameborder="0" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"> <p>Your browser does not support iframes.</p> </iframe> </div> <p><a href="content/videos/AddField.mp4" target="_blank">View Image in New Tab</a></p> <h2 id="summary-table"> <a href="#summary-table" class="anchor-heading" aria-labelledby="summary-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Summary Table </h2> <p>Summarizing by a field (eg. DAUID - the Dissemination Unit ID) allows us to get statistics of interest for specific columns.</p> <p><strong class="label label-blue">8</strong> Make sure you clear the selection. Right click on DAUID in the attribute table and click Summarize.</p> <ul> <li>Set Green Veg Area as the Field and choose Sum as the statistic type.</li> <li>Make sure DAUID as the Case Field.</li> <li>The resulting table will show the total of just the green vegetation area per DA, and can be joined to the Van_DA_2016 layer.</li> </ul> <div style="overflow: hidden; padding-top: 56.25%; position: relative"> <iframe src="content/videos/SummaryTable.mp4" title="Processes" scrolling="no" frameborder="0" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"> <p>Your browser does not support iframes.</p> </iframe> </div> <p><a href="content/videos/SummaryTable.mp4" target="_blank">View Image in New Tab</a></p> <h2 id="join-the-summary-table"> <a href="#join-the-summary-table" class="anchor-heading" aria-labelledby="join-the-summary-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Join the Summary Table </h2> <p><strong class="label label-blue">9</strong> Do a <strong>Join</strong> to add the Summary Table output to Van_DA_2016. Following the same steps as above but use the Summary Table you just generated as the Join Table. Now, Van_DA_2016 has “greenness” quantified by two different methods. Method 1) gives us the average NDVI value per DA. Method 2) gives us the total “green vegetation” area per DA.</p> <h2 id="data-normalization"> <a href="#data-normalization" class="anchor-heading" aria-labelledby="data-normalization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data Normalization </h2> <!-- {: .no_toc } --> <p>One last thing we need to do is control for any confounding factors. For example, the DAs are different sizes. To get a better sense of green vegetation per DA, we will Normalize the Green Vegetation area by the Shape Area of the DAs. This is known as <strong>Normalizing</strong>, sometimes also referred to as standardizing. It is the process of dividing one variable by another variable to account for their relationship. It can help us identify patterns that might be masked by a confounding variable. We’ll discuss normalization in more depth in lecture later on in term.</p> <p><strong class="label label-blue">10</strong> In the VanDA_2016 attribute table, add a Field called <strong>Green_Vegetation_Fraction</strong>.</p> <ul> <li>Give it the alias Green Vegetation Fraction.</li> <li>Make sure its type is: double.</li> </ul> <p><strong class="label label-blue">11</strong> Use the field calculator to apply an expression to your <strong>Green Vegetation Fraction</strong> field.</p> <ul> <li>Divide SUM_Green_Veg_Area (yours might have a slightly different name) by the Shape_Area. This will give us the percentage of the DA that is covered by Dense Green Vegetation.</li> </ul> <div style="overflow: hidden; padding-top: 56.25%; position: relative"> <iframe src="content/videos/Norm.mp4" title="Processes" scrolling="no" frameborder="0" style="border: 0; height: 100%; left: 0; position: absolute; top: 0; width: 100%;"> <p>Your browser does not support iframes.</p> </iframe> </div> <p><a href="content/videos/Norm.mp4" target="_blank">View Image in New Tab</a></p> <h1 id="inspect-and-compare-the-outputs"> <a href="#inspect-and-compare-the-outputs" class="anchor-heading" aria-labelledby="inspect-and-compare-the-outputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Inspect and Compare the Outputs </h1> <p><strong class="label label-green">1</strong> Open the Attribute Table of VanDA_2016. Double click on <strong>Mean</strong> to sort by that column in ascending/descending order. Take note of the DAUID for of the DA with the highest value. Do the same for <strong>Green Veg Fraction</strong>. Are they the same?</p> <p><strong class="label label-green">2</strong> Create a new Scatter plot. Set the X-axis to <strong>Green Veg Fraction</strong> and the Y-axis to <strong>Mean</strong>. Think about the relationship between these variables and what might describe the pattern you see.</p> <p><strong class="label label-green">3</strong> Change the Y-axis to <strong>Income</strong>. Make sure to <strong>Exclude the zeros</strong> using the same procedure as earlier. Look at the resulting relationship. Is the <strong>Green Veg Fraction</strong> a good predictor of income? Try changing the X-axis to <strong>Mean</strong> to see if it gives a better result?</p> <!-- ### QA6 What is the DAUID of the DA with the highest Green Veg Area? ### QA7 Is the DA with the highest mean NDVI value the same as the DA with the greatest area of green vegetation? Y/N ### QA8 Create a scatter plot, with the Mean NDVI value (Output from Method 1) on the X-axis Green and Veg Area Sum (Output from Method 2) on the Y-axis. What is the R2 value? ### QA9 The r2 score indicates Mean NDVI value is [Strong/Moderate/Weak/Very Weak] predictor of Green Veg Area. ### QA10 Change the Y-axis to Income and leave the X-axis as Mean NDVI, note the R2 score. Now change the X-axis to the Green Veg Area Sum and note the R2 score. Which variable has a "stronger" relationship with income? [Green Veg Area/Mean NDVI] ### QA11 Are either of these variables strongly linked to income? [Yes/No/Just Mean NDIV/Just Green Veg Area] --> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
